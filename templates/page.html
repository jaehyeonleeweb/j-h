{% extends "base.html" %}
{% block content %}

<article class="page-two-col" role="article">

  <aside class="page-meta" role="complementary">

    <div class="meta-block meta-title">
      <strong>{{ page.title }}</strong>
    </div>

    <div class="meta-block meta-data">

      {% if page.extra.doc_no %}
        <div class="meta-line">
          {% if lang == "kr" %}
            ë¬¸ì„œ ë²ˆí˜¸ â†’ [{{ page.extra.doc_no }}]
          {% else %}
            Document No. â†’ [{{ page.extra.doc_no }}]
          {% endif %}
        </div>
      {% endif %}
    
      {% if page.extra.category %}
        <div class="meta-line">
          {% if lang == "kr" %}
            ì¹´í…Œê³ ë¦¬ â†’ [{{ page.extra.category }}]
          {% else %}
            Category â†’ [{{ page.extra.category }}]
          {% endif %}
        </div>
      {% endif %}
    
      {% if page.extra.author %}
      <div class="meta-line">
        {% if lang == "kr" %}
          ì €ì â†’
        {% else %}
          Author â†’
        {% endif %}
    
        {% set authors = page.extra.author %}
        {% if authors is string %}
          [{{ authors }}]
        {% else %}
          {% for item in authors %}
            [{{ item }}]{% if not loop.last %}, {% endif %}
          {% endfor %}
        {% endif %}
      </div>
    {% endif %}
    
    
    {% if page.extra.format %}
      <div class="meta-line">
        {% if lang == "kr" %}
          í˜•ì‹ â†’
        {% else %}
          Format â†’
        {% endif %}
    
        {% set formats = page.extra.format %}
        {% if formats is string %}
          [{{ formats }}]
        {% else %}
          {% for item in formats %}
            [{{ item }}]{% if not loop.last %}, {% endif %}
          {% endfor %}
        {% endif %}
      </div>
    {% endif %}
    
    
    {% if page.extra.print %}
      <div class="meta-line">
        {% if lang == "kr" %}
          ì¸ì‡„ â†’
        {% else %}
          Print â†’
        {% endif %}
    
        {% set prints = page.extra.print %}
        {% if prints is string %}
          [{{ prints }}]
        {% else %}
          {% for item in prints %}
            [{{ item }}]{% if not loop.last %}, {% endif %}
          {% endfor %}
        {% endif %}
      </div>
    {% endif %}
    
    
    {% if page.extra.date_ym %}
      <div class="meta-line">
        {% if lang == "kr" %}
          ë‚ ì§œ â†’
        {% else %}
          Date â†’
        {% endif %}
    
        {% set dates = page.extra.date_ym %}
        {% if dates is string %}
          [{{ dates }}]
        {% else %}
          {% for item in dates %}
            [{{ item }}]{% if not loop.last %}, {% endif %}
          {% endfor %}
        {% endif %}
      </div>
    {% endif %}

      {% if page.extra.link %}
      {% set is_method =
        page.extra.category == "Method"
        or page.extra.category == "ë°©ë²•"
      %}
    
      <div class="meta-line">
        {% if is_method %}
          {% if lang == "kr" %}
            ì´ ë°©ë²•ì´ ì‚¬ìš©ëœ ì‘ì—… â†’
          {% else %}
            Work using this method â†’
          {% endif %}
        {% else %}
          {% if lang == "kr" %}
            ê´€ë ¨í•œ ë¬¸ì„œ â†’
          {% else %}
            Related documents â†’
          {% endif %}
        {% endif %}
    
        {% for item in page.extra.link %}
          {% if item.href %}
            [<a href="{{ item.href }}">{% if item.label %}{{ item.label }}{% else %}link{% endif %}</a>]{% if not loop.last %}, {% endif %}
          {% endif %}
        {% endfor %}
      </div>
    {% endif %}
  
  
    
    </div>
    

    {% if page.extra.meta_description %}
    <div class="meta-block meta-desc">
      {% for line in page.extra.meta_description %}
        <div class="meta-line">
          â†’ {{ line | markdown(inline=true) | safe }}
        </div>
      {% endfor %}
    </div>
    {% endif %}
    

    {% if page.extra.notes %}
    <div class="meta-block meta-notes">
      {% for note in page.extra.notes %}
        <div
          class="meta-line meta-note"
          data-fnid="{{ note.id }}"
          role="link"
          tabindex="0"
        >
          <span class="footnote-num">{{ note.id }}</span>
          <span class="footnote-arrow"> â†’ </span>
          <span class="footnote-text">
            {{ note.text | markdown(inline=true) | safe }}
          </span>
        </div>
      {% endfor %}
    </div>
    {% endif %}
    

  </aside>

  <div class="page-body page-content">

    {{ page.content | safe }}

  </div>

</article>

<script>
  (function () {
  
    function isVisible(el) {
      return !!(el && el.offsetParent !== null);
    }
  
    function isInViewport(el) {
      if (!el) return false;
      const r = el.getBoundingClientRect();
      return r.bottom > 0 && r.top < window.innerHeight;
    }
  
    function scrollToRef(el, block) {
      if (!el) return;
      el.scrollIntoView({
        behavior: "smooth",
        block: block
      });
    }
  
    function scrollDocumentToRevealMeta() {
      window.scrollTo({
        top: document.documentElement.scrollHeight,
        behavior: "smooth"
      });
    }
  
    function setActiveFootnote(id) {
      history.pushState(null, "", "#fn-" + id);
  
      document.querySelectorAll(".meta-note").forEach(el => {
        el.classList.toggle("is-active", el.dataset.fnid === id);
      });
  
      document.querySelectorAll(".footnote-definition").forEach(el => {
        el.classList.toggle("is-active", el.id === id);
      });
    }
  
    const mqDesktop = window.matchMedia("(min-width: 600px)");
  
    document.addEventListener("click", function (e) {
  
      const meta = e.target.closest(".meta-note[data-fnid]");
      if (meta) {
        if (e.target.closest("a")) return;
  
        const id = meta.dataset.fnid;
        if (!id) return;
  
        const ref = document.querySelector(
          '.footnote-reference a[href="#' + id + '"]'
        );
        if (!ref) return;
  
        scrollToRef(ref, "start");
        setActiveFootnote(id);
        return;
      }
  
      const def = e.target.closest(".footnote-definition[id]");
      if (def) {
        if (e.target.closest("a")) return;
  
        const id = def.id;
        if (!id) return;
  
        const ref = document.querySelector(
          '.footnote-reference a[href="#' + id + '"]'
        );
        if (!ref) return;
  
        scrollToRef(ref, "start");
        setActiveFootnote(id);
        return;
      }
  
      const refLink = e.target.closest(".footnote-reference a[href^='#']");
      if (!refLink) return;
  
      e.preventDefault();
  
      const id = refLink.getAttribute("href").slice(1);
      if (!id) return;
  
      setActiveFootnote(id);
  
      if (mqDesktop.matches) {
        const metaTarget = document.querySelector(
          ".meta-note[data-fnid='" + id + "']"
        );
  
        if (metaTarget && isVisible(metaTarget)) {
          if (!isInViewport(metaTarget)) {
            scrollDocumentToRevealMeta(metaTarget);
          }
          return;
        }
      }
  
      const footTarget = document.getElementById(id);
      if (footTarget && isVisible(footTarget)) {
        scrollToRef(footTarget, "end");
      }
    });
  
    document.addEventListener("DOMContentLoaded", function () {
      if (!location.hash.startsWith("#fn-")) return;
  
      const id = location.hash.replace("#fn-", "");
      if (!id) return;
  
      setActiveFootnote(id);
  
      if (mqDesktop.matches) {
        const metaTarget = document.querySelector(
          ".meta-note[data-fnid='" + id + "']"
        );
        if (metaTarget && isVisible(metaTarget)) {
          if (!isInViewport(metaTarget)) {
            scrollDocumentToRevealMeta(metaTarget);
          }
          return;
        }
      }
  
      const footTarget = document.getElementById(id);
      if (footTarget && isVisible(footTarget)) {
        scrollToRef(footTarget, "end");
      }
    });
  
  })();
  </script>  
  
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const PUNCTS = `"'\u2018\u201C([{â€¹Â«ã€ˆã€Šã€Œã€`;
    
        const targets = document.querySelectorAll(
  '.page-meta .meta-title, \
   .page-meta .meta-line, \
   .page-body .page-content p, \
   .page-body .page-content li'
);

    
      targets.forEach(el => {
        const text = (el.textContent || '').trimStart();
        if (!text) return;
    
        const firstChar = text[0];
        if (!PUNCTS.includes(firstChar)) return;
    
        el.classList.add('hang-punct');
      });
    });
    </script>
    
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const superscriptMap = {
          "0": "â°",
          "1": "Â¹",
          "2": "Â²",
          "3": "Â³",
          "4": "â´",
          "5": "âµ",
          "6": "â¶",
          "7": "â·",
          "8": "â¸",
          "9": "â¹"
        };
      
        document
          .querySelectorAll("sup.footnote-reference a")
          .forEach(el => {
            const text = el.textContent.trim();
      
            // ìˆ«ìë§Œ ì²˜ë¦¬
            if (!/^\d+$/.test(text)) return;
      
            const superscript = [...text]
              .map(d => superscriptMap[d] || d)
              .join("");
      
            el.textContent = superscript;
            el.setAttribute("aria-label", `Footnote ${text}`);
          });
      });
      </script>
      
      <script>
        (function () {
          const root = document.querySelector(".page-body.page-content");
          if (!root) return;

          root.querySelectorAll("blockquote ol > li").forEach(li => {
            if (li.querySelector(":scope > .li-body")) return;

            const body = document.createElement("span");
            body.className = "li-body";

            const nodes = Array.from(li.childNodes);

            nodes.forEach(node => {
              // ğŸ”‘ ìˆ«ììš© ::beforeëŠ” ê±´ë“œë¦¬ì§€ ë§ê³ 
              // ğŸ”‘ ì‹¤ì œ DOM ìì‹ë§Œ ì´ë™
              if (
                node.nodeType === Node.ELEMENT_NODE ||
                (node.nodeType === Node.TEXT_NODE && node.textContent.trim() !== "")
              ) {
                body.appendChild(node);
              }
            });

            li.appendChild(body);
          });
        })();
        </script>
        

{% endblock content %}
